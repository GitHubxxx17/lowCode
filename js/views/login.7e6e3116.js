import{u as e,_ as s,c as a,r,l as o}from"../userStore/userStore.3b024ab0.js";import{p as t,s as l}from"../index.b6bd6361.js";import{E as i,a as m,b as u,c as n}from"../element-plus/element-plus.739d7a40.js";import{Z as p,r as d,o as c,c as f,a as g,U as h,O as w,u as v,M as j,R as b,T as k}from"../@vue/@vue.5b184091.js";import"../axios/axios.5ae1da96.js";import"../pinia/pinia.e5f2e591.js";import"../mitt/mitt.f0e54764.js";import"../fundebug-javascript/fundebug-javascript.4b005614.js";import"../dayjs/dayjs.fdf8d021.js";import"../fundebug-vue/fundebug-vue.04a7ac72.js";import"../vue-router/vue-router.f65266be.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.9fc9a9b5.js";import"../@element-plus/@element-plus.cb377f36.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../async-validator/async-validator.8d480e59.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.5fea19da.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.01901ece.js";const x={class:"login"},y={class:"login-box"},N=g("div",{class:"login-box-avatar"},[g("img",{src:s})],-1),V={__name:"login",setup(s){sessionStorage.clear();const V=e(t);let _=p({changeName:"注册",confirmName:"登录",isRegister:!1}),P=d(null);const E=()=>{"注册"==_.changeName?(_.isRegister=!0,_.changeName="登录",_.confirmName="注册"):(_.isRegister=!1,_.changeName="注册",_.confirmName="登录"),R.username="",R.password="",R.checkPassword="",P.value.resetFields()};let R=p({username:"",password:"",checkPassword:""});let z=p({username:[{min:3,max:10,message:"用户名长度应在 3-10 个字符",trigger:"blur"},{validator:async(e,s,r)=>{if(""===s)r(new Error("请输入用户名"));else{let e=await a(R.username);if("注册"===_.confirmName){let s=e.data;s.status?r(new Error(s.msg)):r()}else{e.data.status?r():r("该用户名不存在！")}}},trigger:"blur"}],password:[{min:6,max:15,message:"密码长度应在 6-15 个字符",trigger:"blur"},{validator:(e,s,a)=>{""===s?a(new Error("请输入密码")):(""!==R.checkPassword&&P.value.validateField("checkPassword"),a())},trigger:"blur"}],checkPassword:[{validator:(e,s,a)=>{""===s?a(new Error("请再次输入密码")):s!==R.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}]});return(e,s)=>(c(),f("div",x,[g("div",y,[N,h(v(u),{ref_key:"formRef",ref:P,model:v(R),rules:v(z),"label-width":"100px",class:"login-box-form",autocomplete:"off"},{default:w((()=>[h(v(i),{label:"用  户  名：",prop:"username"},{default:w((()=>[h(v(m),{placeholder:"请输入用户名",modelValue:v(R).username,"onUpdate:modelValue":s[0]||(s[0]=e=>v(R).username=e),"input-style":"height:35px;",autocomplete:"off"},null,8,["modelValue"])])),_:1}),h(v(i),{label:"密       码：",prop:"password"},{default:w((()=>[h(v(m),{placeholder:"请输入密码",modelValue:v(R).password,"onUpdate:modelValue":s[1]||(s[1]=e=>v(R).password=e),"input-style":"height:35px;","show-password":"",type:"password",autocomplete:"off"},null,8,["modelValue"])])),_:1}),v(_).isRegister?(c(),j(v(i),{key:0,label:"确认密码：",prop:"checkPassword"},{default:w((()=>[h(v(m),{placeholder:"请再次输入密码",modelValue:v(R).checkPassword,"onUpdate:modelValue":s[2]||(s[2]=e=>v(R).checkPassword=e),"input-style":"height:35px;","show-password":"",type:"password",autocomplete:"off"},null,8,["modelValue"])])),_:1})):b("",!0),h(v(i),{class:"login-box-form-btns"},{default:w((()=>[g("button",{type:"button",class:"confirm",onClick:s[3]||(s[3]=s=>{return a=e.$router,void P.value.validate((async e=>{if(!e)return;let s=!1,t=null;if(t="注册"===_.confirmName?await r(R.username,R.password):await o(R.username,R.password),t){let e=t.data;e.status?n.error(e.msg):(n.success(e.msg),s=!0),s&&(V.username=e.username,V.token=e.token,l("token",e.token),l("username",e.username),a.push("/home"))}else n.success(_.confirmName+"异常，请重试！")}));var a})}," 立即"+k(v(_).confirmName),1),g("div",{class:"change",onClick:s[4]||(s[4]=e=>E())}," 去"+k(v(_).changeName),1)])),_:1})])),_:1},8,["model","rules"])])]))}};export{V as default};
