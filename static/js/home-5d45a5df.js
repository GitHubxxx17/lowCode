import{m as a,u as e,_ as t}from"./userStore-38c6f3d2.js";import{w as i,P as l,x as s,y as d,z as o,h as n}from"./home-8c829457.js";import{X as r,p as c,bQ as m,r as h,aE as u,aV as g,o as v,c as p,b,d as f,w as y,u as D,bP as k,F as x,aT as I,Q as E,bG as w,i as V,av as j,t as C}from"./index-66b152c9.js";const _=""+new URL("../png/noneData1-cb06f12f.png",import.meta.url).href,S=r({props:{EditorData:Object},setup:a=>()=>{var e;return i(null==(e=a.EditorData)?void 0:e.body)}}),O={class:"home"},P={class:"home-header"},F=b("div",{class:"home-header-left"},[b("h2",null,"codeFlow")],-1),J={class:"home-header-right"},N=b("div",{class:"home-header-right-avatar"},[b("img",{src:t,alt:"user"})],-1),Q={class:"home-body"},U={class:"home-body-left"},$=b("div",{class:"home-body-left-header"},[b("span",null,"我的页面")],-1),z={class:"home-body-left-content"},G=["onClick"],L={class:"title"},R=["onClick"],T={class:"home-body-right"},X={key:0,class:"home-body-right-viewer"},q={key:1,class:"home-body-right-none"},A=[b("img",{src:_,alt:"没有页面捏"},null,-1)],B=b("span",null,"确认删除该页面吗？",-1),H={class:"dialog-footer"},K=r({__name:"home",setup(t){const i=a(c);e(c).token=m("token");const r=h({editdata:[],dialogVisible:!1,delIndex:0,selectIndex:0}),_=a=>{r.editdata.forEach(((e,t)=>{e.active=!1,t==a&&(e.active=!0,i.EditorData=e.jsonData,i.title=e.title,r.selectIndex=e.id)}))},K=async()=>{let a=await d(r.editdata[r.delIndex].id);r.dialogVisible=!1,r.editdata.splice(r.delIndex,1);let e=r.editdata.length;if(0==e)return i.EditorData=null,localStorage.removeItem("title"),void localStorage.removeItem("data");_(r.delIndex==e?r.delIndex-1:r.delIndex),V.success({message:a.data.msg,duration:2e3})};return u((()=>{(async()=>{let a=await s();r.editdata=a.data.editData.map(((a,e)=>(a.jsonData=JSON.parse(a.jsonData),a.active=!1,0==e&&(a.active=!0,i.EditorData=a.jsonData,i.title=a.title,r.selectIndex=a.id),a))),r.editdata})()})),(a,e)=>{const t=g("el-button"),s=g("el-dialog");return v(),p(x,null,[b("div",O,[b("header",P,[F,b("div",J,[b("div",{class:"home-header-right-btn",onClick:e[0]||(e[0]=e=>(a.$router.push("/editor"),w("title",i.title),w("data",i.EditorData),void w("id",r.selectIndex)))}," 进入编辑 "),b("div",{class:"home-header-right-btn",onClick:e[1]||(e[1]=e=>(async a=>{let e=await o({title:"未命名页面",jsonData:JSON.stringify(n)});V.success({message:e.data.msg,duration:1e3}),a.push("/editor"),w("title","未命名页面"),w("data",n),w("id",e.data.id)})(a.$router))}," 新建页面 "),f(D(k),{placement:"bottom",width:200,trigger:"click"},{reference:y((()=>[N])),default:y((()=>[f(D(l))])),_:1})])]),b("section",Q,[b("div",U,[$,b("div",z,[b("ul",null,[(v(!0),p(x,null,I(r.editdata,((a,e)=>(v(),p("li",{class:j({active:a.active}),onClick:a=>_(e),key:a.id},[b("div",L,C(a.title),1),b("i",{class:"del icon iconfont icon-cha",onClick:a=>((a,e)=>{a.stopPropagation(),r.delIndex=e,r.dialogVisible=!0})(a,e)},null,8,R)],10,G)))),128))])])]),b("div",T,[r.editdata.length?(v(),p("div",X,[f(D(S),{EditorData:D(i).EditorData},null,8,["EditorData"])])):(v(),p("div",q,A))])])]),f(s,{title:"删除页面",modelValue:r.dialogVisible,"onUpdate:modelValue":e[3]||(e[3]=a=>r.dialogVisible=a),width:"30%"},{footer:y((()=>[b("span",H,[f(t,{onClick:e[2]||(e[2]=a=>r.dialogVisible=!1)},{default:y((()=>[E("取 消")])),_:1}),f(t,{type:"primary",onClick:K},{default:y((()=>[E("确 定")])),_:1})])])),default:y((()=>[B])),_:1},8,["modelValue"])],64)}}});export{K as default};
