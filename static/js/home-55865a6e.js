import{_ as N}from"./user-339da0c7.js";import{r as T,m as $,b as v,c as D,l as b,_ as G}from"./useStorage-c93c3cb3.js";import{U as V,bG as O,r as E,aC as P,aT as y,o as h,c as u,b as t,F as w,aR as B,d as n,u as C,w as r,O as x,at as F,t as J,aM as M,aJ as U}from"./index-2d7a9430.js";import{s as p}from"./index-765abcf3.js";const z=V({props:{EditorData:Object},setup(i){return()=>{var o;return T((o=i.EditorData)==null?void 0:o.body)}}});function H(){return p({method:"get",url:"/getEditData",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function L(i){return p({method:"get",url:`/delEditData?id=${i}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function R(i){return p({method:"post",url:"/addEditData",headers:{"Content-Type":"application/json;charset=utf-8"},data:i})}const c=i=>(M("data-v-0c63cbfe"),i=i(),U(),i),q={class:"home"},A={class:"home-header"},K=c(()=>t("div",{class:"home-header-left"},[t("h2",null,"codeFlow")],-1)),Q={class:"home-header-right"},W=c(()=>t("div",{class:"home-header-right-avatar"},[t("img",{src:N,alt:"user"})],-1)),X={class:"home-body"},Y={class:"home-body-left"},Z=c(()=>t("div",{class:"home-body-left-header"},[t("span",null,"我的页面")],-1)),tt={class:"home-body-left-content"},et=["onClick"],at={class:"title"},ot=["onClick"],st={class:"home-body-right"},dt={class:"home-body-right-viewer"},it=c(()=>t("span",null,"确认删除该页面吗？",-1)),lt={class:"dialog-footer"},nt=V({__name:"home",setup(i){const o=$(O);o.EditorData=v("data")?v("data"):E(D);const e=E({editdata:[],dialogVisible:!1,delIndex:0});P(()=>{(async()=>{let a=await H();e.editdata=a.data.map((d,_)=>(d.jsonData=JSON.parse(d.jsonData),d.active=!1,_==0&&(d.active=!0,o.EditorData=d.jsonData,o.title=d.title),d)),console.log(e.editdata)})()});const f=s=>{e.editdata.forEach((a,d)=>{a.active=!1,d==s&&(a.active=!0,o.EditorData=a.jsonData,o.title=a.title)})},I=s=>{s.push("/editor"),b("title",o.title),b("data",o.EditorData)},k=(s,a)=>{s.stopPropagation(),e.delIndex=a,e.dialogVisible=!0},S=async()=>{let s=await L(e.editdata[e.delIndex].id);console.log(s),e.dialogVisible=!1,e.editdata.splice(e.delIndex,1);let a=e.editdata.length;if(a==0){o.EditorData=null,localStorage.clear();return}f(e.delIndex==a?e.delIndex-1:e.delIndex)},j=async()=>{let s=await R({uId:1,title:"未命名页面",jsonData:JSON.stringify(D)});console.log(s)};return(s,a)=>{const d=y("el-button"),_=y("el-dialog");return h(),u(w,null,[t("div",q,[t("header",A,[K,t("div",Q,[t("div",{class:"home-header-right-btn",onClick:a[0]||(a[0]=l=>I(s.$router))}," 进入编辑 "),t("div",{class:"home-header-right-btn",onClick:j},"新建页面"),W])]),t("section",X,[t("div",Y,[Z,t("div",tt,[t("ul",null,[(h(!0),u(w,null,B(e.editdata,(l,m)=>(h(),u("li",{class:F({active:l.active}),onClick:g=>f(m),key:l.id},[t("div",at,J(l.title),1),t("i",{class:"del icon iconfont icon-cha",onClick:g=>k(g,m)},null,8,ot)],10,et))),128))])])]),t("div",st,[t("div",dt,[n(C(z),{EditorData:C(o).EditorData},null,8,["EditorData"])])])])]),n(_,{title:"删除页面",modelValue:e.dialogVisible,"onUpdate:modelValue":a[2]||(a[2]=l=>e.dialogVisible=l),width:"30%"},{footer:r(()=>[t("span",lt,[n(d,{onClick:a[1]||(a[1]=l=>e.dialogVisible=!1)},{default:r(()=>[x("取 消")]),_:1}),n(d,{type:"primary",onClick:S},{default:r(()=>[x("确 定")]),_:1})])]),default:r(()=>[it]),_:1},8,["modelValue"])],64)}}});const ut=G(nt,[["__scopeId","data-v-0c63cbfe"]]);export{ut as default};
