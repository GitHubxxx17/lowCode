import{_ as z}from"./user-339da0c7.js";import{r as P,m as B,b,_ as F}from"./useRender-b961080e.js";import{X as V,p,bO as L,r as M,aE as G,aV as y,o as l,c as r,b as e,F as E,aT as J,d as u,u as k,w as h,Q as w,bM as _,i as C,av as U,t as H,aO as Q,aL as R}from"./index-855c39e2.js";import{u as x,s as m}from"./userStore-44121105.js";const X=""+new URL("../png/noneData1-cb06f12f.png",import.meta.url).href,q=V({props:{EditorData:Object},setup(d){return()=>{var s;return P((s=d.EditorData)==null?void 0:s.body)}}}),g=x(p);function A(){return m({method:"get",url:"/getEditData",headers:{"Content-Type":"application/x-www-form-urlencoded",authorization:g.token}})}function K(d){return m({method:"post",url:"/delEditData",headers:{"Content-Type":"application/x-www-form-urlencoded",authorization:g.token},data:{id:d}})}function W(d){return m({method:"post",url:"/addEditData",headers:{"Content-Type":"application/json;charset=utf-8",authorization:g.token},data:d})}const c=d=>(Q("data-v-dd240338"),d=d(),R(),d),Y={class:"home"},Z={class:"home-header"},tt=c(()=>e("div",{class:"home-header-left"},[e("h2",null,"codeFlow")],-1)),et={class:"home-header-right"},at=c(()=>e("div",{class:"home-header-right-avatar"},[e("img",{src:z,alt:"user"})],-1)),ot={class:"home-body"},st={class:"home-body-left"},dt=c(()=>e("div",{class:"home-body-left-header"},[e("span",null,"我的页面")],-1)),it={class:"home-body-left-content"},nt=["onClick"],lt={class:"title"},rt=["onClick"],ct={class:"home-body-right"},ut={key:0,class:"home-body-right-viewer"},ht={key:1,class:"home-body-right-none"},_t=c(()=>e("img",{src:X,alt:"没有页面捏"},null,-1)),pt=[_t],mt=c(()=>e("span",null,"确认删除该页面吗？",-1)),gt={class:"dialog-footer"},ft=V({__name:"home",setup(d){const s=B(p),I=x(p);I.token=L("token");const a=M({editdata:[],dialogVisible:!1,delIndex:0}),S=async()=>{let o=await A();a.editdata=o.data.editData.map((t,n)=>(t.jsonData=JSON.parse(t.jsonData),t.active=!1,n==0&&(t.active=!0,s.EditorData=t.jsonData,s.title=t.title),t)),console.log(a.editdata)},f=o=>{a.editdata.forEach((t,n)=>{t.active=!1,n==o&&(t.active=!0,s.EditorData=t.jsonData,s.title=t.title)})},j=o=>{o.push("/editor"),_("title",s.title),_("data",s.EditorData)},$=(o,t)=>{o.stopPropagation(),a.delIndex=t,a.dialogVisible=!0},N=async()=>{let o=await K(a.editdata[a.delIndex].id);console.log(o),a.dialogVisible=!1,a.editdata.splice(a.delIndex,1);let t=a.editdata.length;if(t==0){s.EditorData=null,localStorage.removeItem("title"),localStorage.removeItem("data");return}f(a.delIndex==t?a.delIndex-1:a.delIndex),C.success({message:o.data.msg,duration:2e3})},O=async o=>{let t=await W({title:"未命名页面",jsonData:JSON.stringify(b)});C.success({message:t.data.msg,duration:1e3}),o.push("/editor"),_("title","未命名页面"),_("data",b),console.log(t)};return G(()=>{S()}),(o,t)=>{const n=y("el-button"),T=y("el-dialog");return l(),r(E,null,[e("div",Y,[e("header",Z,[tt,e("div",et,[e("div",{class:"home-header-right-btn",onClick:t[0]||(t[0]=i=>j(o.$router))}," 进入编辑 "),e("div",{class:"home-header-right-btn",onClick:t[1]||(t[1]=i=>O(o.$router))}," 新建页面 "),at])]),e("section",ot,[e("div",st,[dt,e("div",it,[e("ul",null,[(l(!0),r(E,null,J(a.editdata,(i,v)=>(l(),r("li",{class:U({active:i.active}),onClick:D=>f(v),key:i.id},[e("div",lt,H(i.title),1),e("i",{class:"del icon iconfont icon-cha",onClick:D=>$(D,v)},null,8,rt)],10,nt))),128))])])]),e("div",ct,[a.editdata.length?(l(),r("div",ut,[u(k(q),{EditorData:k(s).EditorData},null,8,["EditorData"])])):(l(),r("div",ht,pt))])])]),u(T,{title:"删除页面",modelValue:a.dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=i=>a.dialogVisible=i),width:"30%"},{footer:h(()=>[e("span",gt,[u(n,{onClick:t[2]||(t[2]=i=>a.dialogVisible=!1)},{default:h(()=>[w("取 消")]),_:1}),u(n,{type:"primary",onClick:N},{default:h(()=>[w("确 定")]),_:1})])]),default:h(()=>[mt]),_:1},8,["modelValue"])],64)}}});const Et=F(ft,[["__scopeId","data-v-dd240338"]]);export{Et as default};
