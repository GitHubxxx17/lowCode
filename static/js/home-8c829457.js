import{bR as e,p as t,i as n,bu as o,aS as l,X as a,d as i,aV as s,e as r,F as d,ap as c,Q as u,a as p,aE as m,at as g,bS as f,bN as y,r as h,o as v,f as w,w as b,u as C,h as x,E,b as D,s as P,bQ as M,bT as k}from"./index-66b152c9.js";import{m as S,a as L,d as R,s as T,u as K,c as V,_ as N}from"./userStore-38c6f3d2.js";const O={type:"page",title:"Hello world",style:{},body:[{type:"container-ordinary",style:{position:"relative",width:"100%",zIndex:1},children:[{type:"button",style:{display:"",position:"relative",zIndex:1},buttonstyle:"primary",size:"default",icon:{},twiceComfire:{},bubblePrompt:{triggerMode:"鼠标悬浮",promptLocation:"下"},isDisable:!1,children:"我的按钮"},{type:"text",style:{position:"relative",fontSize:"20px",color:"blue",zIndex:1},children:"(｡･∀･)ﾉﾞ"},{type:"input",value:"",inputStyle:"text",size:"default",defaultValue:"123",placeholder:"",showPassword:!1,maxlength:0,minlength:0,showWordLimit:!0,style:{position:"relative",zIndex:1},children:""}]}]},z=e("dragStore",{state:()=>({selectedMaterial:null,isClone:!1,isDrag:!1,isDraging:!1,selectKey:null,selectParent:null,selectedComponent:null,containerData:null,selectedIndex:null,dragEl:null}),actions:{destructionOfDrag:null}});const I={all:j=j||new Map,on:function(e,t){var n=j.get(e);n?n.push(t):j.set(e,[t])},off:function(e,t){var n=j.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):j.set(e,[]))},emit:function(e,t){var n=j.get(e);n&&n.slice().map((function(e){e(t)})),(n=j.get("*"))&&n.slice().map((function(n){n(e,t)}))}};var j;const U=z(t),_=S(t),F=(e,t)=>{let n=!1,o=null;const l=e=>{if(!n)for(let a=0;a<e.length;a++){const i=e[a];if(i.getAttribute("data-key")==t)return n=!0,void(o=i);if(i.className.includes("container"))return l(i.children[0].children)}};for(let a=0;a<e.length&&!n;a++){if(e[a].getAttribute("data-key")==t)return e[a];e[a].className.includes("container")&&l(e[a].children[0].children)}return o},B=e=>{if(!e.classList)return null;let t=[...e.classList];return t.includes("is-expanded")||t.includes("cannotPreview")||t.includes("container-ordinary")?e:B(e.parentNode)},A=e=>{var t;let n=_.EditorDataMap.get(e),o=null==(t=_.EditorDataMap.get(n.parent))?void 0:t.children;for(let l=0;l<o.length;l++)if(o[l-1]==e)return o[l];return"page"==n.parent?"page":A(n.parent)},H=e=>{var t;_.menuConfig.selectKey=null==(t=B(e.target))?void 0:t.getAttribute("data-key"),_.menuConfig.selectKey==U.selectKey?(_.menuConfig.isShow.selectComponent=!0,_.menuConfig.isShow.unselectComponent=!1,_.menuConfig.isShow.moveForward=!1,_.menuConfig.isShow.moveBack=!1):(_.menuConfig.isShow.selectComponent=!1,_.menuConfig.isShow.unselectComponent=!0,_.menuConfig.isShow.moveForward=!0,_.menuConfig.isShow.moveBack=!0),_.menuConfig.selectKey;const n=window.innerHeight||document.documentElement.clientHeight;e.preventDefault(),_.menuConfig.isShowMenu=!0,n-e.y<390?(e.x<100?_.menuConfig.style.left=e.x+"px":_.menuConfig.style.left=e.x-100+"px",_.menuConfig.style.top=e.y-390+"px"):(_.menuConfig.style.left=e.x+"px",_.menuConfig.style.top=e.y+"px"),e.stopPropagation()},X=()=>{_.menuConfig.isShowMenu=!1},$=e=>{_.menuConfig.isShow.selectComponent?n.info("该组件已经被选中啦！"):_.menuConfig.selectKey?(_.menuConfig.elOutlineTree&&_.menuConfig.elOutlineTree.setCurrentKey(_.menuConfig.selectKey),U.selectKey=_.menuConfig.selectKey,_.menuConfig.isShowMenu=!1):n.error("无法选中！"),e.stopPropagation()},W=e=>{_.menuConfig.isShow.unselectComponent?n.info("这个组件不需要取消选中嘞！"):(U.selectKey=null,_.menuConfig.elOutlineTree&&_.menuConfig.elOutlineTree.setCurrentKey(null),_.menuConfig.isShowMenu=!1),e.stopPropagation()},Y=(e,t)=>{_.menuConfig.isShow.makeACopy?n.info("不可以复制该组件哦！"):(_.copyData=_.menuConfig.selectKey,_.wantCopy=_.menuConfig.selectKey,t.paste(),_.menuConfig.isShowMenu=!1),e.stopPropagation()},q=e=>{_.menuConfig.isShow.copycomponents?n.info("不可以复制该组件哦！"):(_.copyData=_.menuConfig.selectKey,_.menuConfig.isShowMenu=!1),e.stopPropagation()},Q=(e,t)=>{_.menuConfig.isShow.delComponents?n.info("不可以删除该组件哦！"):(_.wantDel=_.menuConfig.selectKey,t.delete(),_.menuConfig.isShowMenu=!1),e.stopPropagation()},G=(e,t)=>{_.menuConfig.isShow.shearComponents?n.info("不可以剪切该组件哦！"):(_.copyData=_.menuConfig.selectKey,_.menuConfig.isShowMenu=!1,Q(e,t)),e.stopPropagation()},J=e=>{var t;if(_.copyData){if(_.menuConfig.isShow.pasteComponents)n.info("不可以粘贴到该组件哦！");else{let e=function(){s(),d(),_.menuConfig.key++},n=function(){r(),i(),_.menuConfig.key--},o=_.EditorDataMap.get(_.menuConfig.selectKey),l=null==(t=_.EditorDataMap.get(o.parent))?void 0:t.children,a=-1;for(let t=0;t<l.length;t++)if(l[t+1]==_.menuConfig.selectKey){a=t;break}let{delUndo:i,delRedo:s}=Z(),{copyUndo:r,copyRedo:d}=ee(a,o.parent);e(),_.queue.push({redo:e,undo:n}),_.curPointerTo+=1,_.menuConfig.isShowMenu=!1}e.stopPropagation()}else n.error("还没有复制组件配置哦！")},Z=()=>{var e;let t=_.menuConfig.selectKey;if(t){let n=(null==(e=_.EditorDataMap.get(t))?void 0:e.parent)||"page",o=_.EditorDataMap.get(n).children.findIndex((e=>e==t));return{delRedo(){_.EditorDataMap.get(n).children.splice(o,1),_.EditorDataMap.get(n)},delUndo(){_.EditorDataMap.get(n).children.splice(o,0,t),_.EditorDataMap.get(n)}}}n.error("编辑区域根节点不能被粘贴配置！")},ee=(e,t)=>{let n=_.copyData,o=_.EditorDataMap.get(n),l=[];return{copyRedo(){_.EditorDataMap.get(t).children.splice(e+1,0,function e(t,n,o){o.parent=n;let a=L(t.replace(/-[^-]*$/,""),R(o));return l.push(a),Array.isArray(o.children)&&(_.EditorDataMap.get(a).children=o.children.map((t=>e(t,a,_.EditorDataMap.get(t))))),a}(n,t,o))},copyUndo(){_.EditorDataMap.get(t).children.splice(e+1,1),l.forEach((e=>{_.EditorDataMap.delete(e)}))}}},te=e=>{if(_.menuConfig.isShow.moveForward)n.error("未选中该节点！");else{let e=(e=>{var t;let n=_.EditorDataMap.get(e),o=null==(t=_.EditorDataMap.get(n.parent))?void 0:t.children;for(let l=0;l<o.length;l++)if(o[l+1]==e)return o[l];return n.parent})(_.menuConfig.selectKey);_.menuConfig.elOutlineTree&&_.menuConfig.elOutlineTree.setCurrentKey(e),_.rootNode&&(U.dragEl=F(_.rootNode.children,e)),_.menuConfig.isShowMenu=!1}e.stopPropagation()},ne=e=>{if(_.menuConfig.isShow.moveForward)n.error("未选中该节点！");else{let e=A(_.menuConfig.selectKey);_.menuConfig.elOutlineTree&&_.menuConfig.elOutlineTree.setCurrentKey(e),_.rootNode&&(U.dragEl=F(_.rootNode.children,e)),_.menuConfig.isShowMenu=!1}e.stopPropagation()},oe=(e,t)=>{_.menuConfig.isShow.undo?n.error("这个组件没有撤销的空间！"):(t.undo(),_.menuConfig.isShowMenu=!1),e.stopPropagation()},le=(e,t)=>{_.menuConfig.isShow.redo?n.error("这个组件没有还原的空间！"):(t.redo(),_.menuConfig.isShowMenu=!1),e.stopPropagation()};const ae=function(){const e=z(t);let n=S(t),a=null,i=null,s=null,r=0,d=0,c=-1,u=[],p=null,m=!1,g=!1,f=null,y=!0;o((()=>e.dragEl),((t,o)=>{t&&void 0===C(t)&&(e.dragEl=o),o&&(o.classList.remove("chosenEl"),w(o.parentNode).classList.remove("chosen-container")),t?(n.rootNode.classList.remove("chosen-container"),i=w(t.parentNode),t.classList.add("chosenEl"),i.classList.add("chosen-container")):n.rootNode.classList.add("chosen-container")})),o((()=>e.selectKey),(t=>{y||(e.dragEl=F(n.rootNode.children[0].children,t))}));const h=()=>{a&&a.remove(),s&&s.remove(),a=null,s=null,e.selectedMaterial=null,e.isClone=!1,e.isDrag||(null==i||i.classList.remove("chosen-container"),i=null,e.isDrag=!1,u=[]),e.isDraging=!1,clearTimeout(p),m=!1,g=!1,document.body.removeEventListener("mousemove",L),document.body.removeEventListener("mousemove",D)};document.body.onmouseup=t=>{if(!b(t.target))return h(),void(y=!1);y=!0,e.isClone&&i&&(e.selectParent=C(i),I.emit("cloneEnd")),(e.isClone||e.isDrag)&&(n.isNeedSave=!0),h()};const v=e=>"DIV"==e.tagName?e.children[0]:"SPAN"==e.tagName?e:v(e.parentNode),w=e=>e.className.includes("container")||e.className.includes("Editorcontainer")?e:w(e.parentNode),b=e=>e.parentNode!=document.body&&(!!(null==e?void 0:e.classList.contains("Editorcontainer"))||b(e.parentNode)),C=e=>{var t;return null==(t=e.attributes["data-key"])?void 0:t.nodeValue},x=()=>{new Promise((t=>{let o=C(f),l=n.EditorDataMap.get(o).children,a=n.EditorDataMap.get(e.selectKey).parent;n.EditorDataMap.get(a).children.splice(c,1),l.push(e.selectKey),n.EditorDataMap.get(e.selectKey).parent=o,i=f,t(l)})).then((t=>{c=t.length-1,e.dragEl=i.children[0].children[c],e.dragEl,e.dragEl.onmousedown=E,P(),m=!1,g=!1}))},E=t=>{c=[].indexOf.call(i.children[0].children,e.dragEl),P(),e.isDraging=!0,k("ghostDrag",e.dragEl,t),document.body.addEventListener("mousemove",D)},D=t=>{b(t.target)&&p&&!g&&(clearTimeout(p),m&&(p=setTimeout(x,300))),L(t);for(let o=0;o<u.length;o++)if(o!==c&&t.clientX>u[o].left&&t.clientX<u[o].right&&t.clientY>u[o].top&&t.clientY<u[o].bottom){let t=n.EditorDataMap.get(e.selectKey).parent,l=n.EditorDataMap.get(t).children;l.splice(c,1),l.splice(o,0,e.selectKey),P(),c=o}},P=()=>{u=[];for(let e of i.children[0].children)u.push(e.getBoundingClientRect())},M=e=>e==document.body?null:"transition"==(null==e?void 0:e.parentNode.className)?e:"transition"==e.className?e.parentNode:"cannotPreview"==e.className?e:M(e.parentNode),k=(e,t,n)=>{const{clientY:o,clientX:l}=n,{top:i,left:s,width:c,height:u}=t.getBoundingClientRect();r=l-s,d=o-i,a=document.createElement("div"),a.classList.add(e),a.style.width=`${c}px`,a.style.height=`${u}px`,a.innerHTML=t.outerHTML,document.body.appendChild(a),a.style.top=`${i}px`,a.style.left=`${s}px`},L=({clientY:e,clientX:t})=>{a.style.top=e-d+"px",a.style.left=t-r+"px"};return{cloneMousedown:(t,n)=>{const o=v(n.target);I.emit("cloneStart"),e.isClone=!0,e.selectedMaterial=t,k("ghostClone",o,n),document.body.addEventListener("mousemove",L)},mouseenter:t=>{if(e.isClone&&(i&&(i.classList.remove("chosen-container"),s&&i.removeChild(s)),i=w(t.target),i.classList.add("chosen-container"),s=document.createElement("div"),s.classList.add("renderEl"),i.appendChild((l(e.selectedMaterial.render({node:e.selectedMaterial.defaultData}),s),s))),e.isDraging){if(clearTimeout(p),e.dragEl==t.target||t.target.classList.contains("Editorcontainer"))return;m=!0,g=!1,f=t.target,p=setTimeout(x,300)}},mouseleave:t=>{if(e.isClone&&(i&&i.classList.remove("chosen-container"),i.removeChild(s),i=w(t.target.parentNode),i.classList.add("chosen-container"),s=document.createElement("div"),s.classList.add("renderEl"),i.appendChild((l(e.selectedMaterial.render({node:e.selectedMaterial.defaultData}),s),s))),e.isDraging){if(m=!1,t.target!=i)return;f=w(t.target.parentNode),g=!0,p=setTimeout(x,300)}},onclickToDrag:t=>{if(t.target,M(t.target),t.target.classList.contains("Editorcontainer"))return i=t.target,t.target.classList.add("chosen-container"),e.selectKey=null,e.dragEl&&(e.dragEl.onmousedown=null),void(e.dragEl=null);M(t.target).classList.contains("Editorcontainer")||t.target!=e.dragEl&&(e.dragEl&&(e.dragEl.onmousedown=null),e.isDrag=!0,e.dragEl=M(t.target)||t.target,e.selectKey=C(e.dragEl),e.dragEl,e.dragEl.onmousedown=E,e.destructionOfDrag=()=>{e.isDrag&&(e.selectKey=null,a&&a.remove(),e.dragEl&&(document.body.removeEventListener("mousemove",D),null==i||i.classList.remove("chosen-container"),e.dragEl.classList.remove("chosenEl"),e.dragEl.onmousedown=null),e.isDraging=!1,e.isDrag=!1,e.dragEl=null)})},deterWhetherToMoveUp:e=>e()}}(),ie=a({props:{option:{type:Object}},setup:e=>()=>i("div",{class:"elCollapseItem base-settings base-events"},[i("p",null,[e.option.label]),i(s("el-input-number"),{modelValue:e.option.value,"onUpdate:modelValue":t=>e.option.value=t,min:e.option.min,max:e.option.max},null)])}),se=a({props:{option:{type:Object}},setup:e=>()=>i(d,null,[i("div",{class:"elCollapseItem base-settings-textarea-text"},[i("div",null,[e.option.label])]),i("div",{class:"elCollapseItem base-settings-textarea"},[i(r,{type:"textarea",modelValue:e.option.value,"onUpdate:modelValue":t=>e.option.value=t},null)])])});const re=a({props:{option:{type:Object}},setup:e=>()=>{let t;return i("div",{class:"elCollapseItem base-settings base-events"},[i("p",null,[e.option.label]),i(s("el-button-group"),null,(n=t=e.option.list.map((t=>i(s("el-button"),{class:"disabled-el-button",type:t.value==e.option.value?"primary":"",onClick:n=>{e.option.value=t.value}},{default:()=>[t.label]}))),"function"==typeof n||"[object Object]"===Object.prototype.toString.call(n)&&!c(n)?t:{default:()=>[t]}))]);var n}}),de=""+new URL("../png/noneData3-4ac3557f.png",import.meta.url).href,ce=[{type:"跳转连接",instructions:"跳转到指定连接的页面",configRender:e=>i(se,{option:e},null),selectedRender:e=>i("p",null,[u("跳转至："),i("span",{class:"events-url"},[e.content])]),handler:e=>()=>{window.open(e.content,"_blank")},defaultData:{label:"页面地址",value:""}},{type:"刷新页面",instructions:"触发浏览器刷新页面",configRender:()=>i("div",{class:"events-none"},[i("img",{src:de},null),i("p",null,[u("无配置内容")])]),selectedRender:e=>i("p",null,[i("span",null,[e.content])]),handler:()=>()=>{location.reload()},defaultData:{value:"刷新页面"}},{type:"回退页面",instructions:"触发浏览器回退",configRender:()=>i("div",{class:"events-none"},[i("img",{src:de},null),i("p",null,[u("无配置内容")])]),selectedRender:e=>i("p",null,[i("span",null,[e.content])]),handler:()=>()=>{history.go(-1)},defaultData:{value:"回退页面"}},{type:"打开弹窗",instructions:"打开弹窗",configRender:e=>i(se,{option:e},null),selectedRender:e=>i("p",null,[i("span",null,[e])]),handler:()=>{},defaultData:{label:"页面地址",value:""}},{type:"关闭弹窗",instructions:"关闭弹窗",configRender:e=>i(se,{option:e},null),selectedRender:e=>i("p",null,[u("跳转至："),i("span",null,[e])]),handler:()=>{},defaultData:{label:"页面地址",value:""}},{type:"消息提醒",instructions:"出现消息提醒框",configRender:e=>i(d,null,[i(re,{option:e.messageType},null),i(ie,{option:e.duration},null),i(se,{option:e.messageContent},null)]),selectedRender:function(e){let t="成功";return this.defaultData.messageType.list.map((n=>{n.value==e.messageType&&(t=n.label)})),i("p",null,[t,u("消息："),i("span",null,[e.messageContent])])},handler:e=>()=>{n({type:e.messageType,message:e.messageContent,duration:e.duration})},defaultData:{messageType:{label:"消息类型",list:[{label:"成功",value:"success"},{label:"警告",value:"warning"},{label:"提示",value:"info"},{label:"错误",value:"error"}],value:"success"},duration:{label:"持续时间",min:0,value:3e3},messageContent:{label:"消息内容",value:""},value:""}},{type:"发送请求",instructions:"发送请求",configRender:e=>i(se,{option:e},null),selectedRender:e=>i("p",null,[u("跳转至："),i("span",null,[e])]),handler:()=>{},defaultData:{label:"页面地址",value:""}},{type:"提交表单",instructions:"提交表单",configRender:e=>i(se,{option:e},null),selectedRender:e=>i("p",null,[u("跳转至："),i("span",null,[e])]),handler:()=>{},defaultData:{label:"页面地址",value:""}},{type:"重置表单",instructions:"重置表单",configRender:e=>i(se,{option:e},null),selectedRender:e=>i("p",null,[u("跳转至："),i("span",null,[e])]),handler:()=>{},defaultData:{label:"页面地址",value:""}},{type:"校验表单",instructions:"校验表单",configRender:e=>i(se,{option:e},null),selectedRender:e=>i("p",null,[u("跳转至："),i("span",null,[e])]),handler:()=>{},defaultData:{label:"页面地址",value:""}}],ue=[{type:"onclick",name:"鼠标点击",execute:e=>({onClick:()=>{e.forEach((e=>e&&e()))}})},{type:"mouseenter",name:"鼠标移入",execute:e=>({onMouseenter:()=>{e.forEach((e=>e&&e()))}})},{type:"mouseleave",name:"鼠标移出",execute:e=>({onmouseleave:()=>{e.forEach((e=>e&&e()))}})},{type:"onfocus",name:"获取焦点",execute:e=>({onFocus:()=>{e.forEach((e=>e&&e()))}})},{type:"onblur",name:"失去焦点",execute:e=>({onBlur:()=>{e.forEach((e=>e&&e()))}})},{type:"onchange",name:"值改变",execute:e=>({onChange:()=>{e.forEach((e=>e&&e()))}})}];const pe=new class{constructor(e=new Map,t=new Map){this.handlerMap=e,this.eventMap=t}getRenderEvents(e){return e.reduce(((e,t)=>Object.assign(e,this.eventMap.get(t.type).execute(t.list.map((e=>this.handlerMap.get(e.title).handler(e)))))),{})}register(e,t=!1){t?this.eventMap.set(e.type,e):this.handlerMap.set(e.type,e)}};for(let Ke of ce)pe.register({type:Ke.type,instructions:Ke.instructions,defaultData:Ke.defaultData,configRender:Ke.configRender,selectedRender:Ke.selectedRender,handler:Ke.handler});for(let Ke of ue)pe.register({type:Ke.type,name:Ke.name,execute:Ke.execute},!0);const me=a({props:{style:Object,children:Object,childrenList:Array,text:String,class:String,events:Object,node:Object},setup(e){let t=p(null);return m((()=>{t.value.attributes.childrenList=e.childrenList})),()=>i("div",g({class:e.class,style:e.style,ref:t,datatype:e.class,onMouseenter:e=>ae.mouseenter(e),onMouseleave:e=>ae.mouseleave(e)},e.events),[0!=(null==e?void 0:e.children.length)&&e.children,0==(null==e?void 0:e.node.children.length)&&i("span",{class:"nochild"},[e.text])])}}),ge=a({props:{option:{type:Object},events:{type:Object}},setup:e=>()=>i(r,g({modelValue:e.option.value,"onUpdate:modelValue":t=>e.option.value=t,style:e.option.style,size:e.option.size,type:e.option.inputStyle,placeholder:e.option.placeholder,showPassword:e.option.showPassword,clearable:e.option.clearable,"show-word-limit":e.option.showWordLimit,disabled:e.option.disabled,readonly:e.option.readonly,autofocus:e.option.autofocus,maxlength:e.option.maxlength,minlength:e.option.minlength},e.events),null)}),fe=a({props:{option:{type:Object},events:{type:Object}},setup:e=>()=>i(f,g({style:e.option.style,filterable:!!e.option.filterable&&e.option.filterable,placeholder:e.option.placeholder?e.option.placeholder:"请选择",modelValue:e.option.defaultValue,"onUpdate:modelValue":t=>e.option.defaultValue=t},e.events),{default:()=>[e.option.selectData&&e.option.selectData.map((e=>i(s("el-option"),{key:e.value,value:e.value},null)))]})}),ye=a({props:{option:{type:Object},events:{type:Object}},setup:e=>()=>i(d,null,[i("div",{style:e.option.style.title},[e.option.title?e.option.title:"文本"]),i(r,g({modelValue:e.option.value,"onUpdate:modelValue":t=>e.option.value=t,style:e.option.style.input,placeholder:e.option.inputBoxPlaceholder?e.option.inputBoxPlaceholder:"",clearable:!!e.option.clearable&&e.option.clearable,type:e.option.inputType?e.option.inputType:"text"},e.events),null)])}),he=a({props:{option:{type:Object},events:{type:Object}},setup:e=>()=>i(d,null,[i("div",{style:e.option.style.title},[e.option.title?e.option.title:"多行文本"]),i(r,g({modelValue:e.option.value,"onUpdate:modelValue":t=>e.option.value=t,style:e.option.style.input,type:"textarea",placeholder:e.option.inputBoxPlaceholder?e.option.inputBoxPlaceholder:"",clearable:!!e.option.clearable&&e.option.clearable,rows:e.option.autosize.minRows},e.events),null)])}),ve=[{label:"用户",icon:"icon iconfont icon-yonghu"},{label:"退出",icon:"icon iconfont icon-h"},{label:"叉 关闭",icon:"icon iconfont icon-cha"},{label:"叉 关闭",icon:"icon iconfont icon-cha1"},{label:"连接",icon:"icon iconfont icon-ai70"},{label:"密码",icon:"icon iconfont icon-mima"},{label:"返回 左箭头",icon:"icon iconfont icon-fanhui"},{label:"搜索",icon:"icon iconfont icon-search"},{label:"笑脸",icon:"icon iconfont icon-xiaolian"},{label:"菜单",icon:"icon iconfont icon-caidan"},{label:"修改",icon:"icon iconfont icon-xiugai"}],we=S(t),be=[{label:"容器",icon:"icon iconfont icon-checkbox",type:"container-ordinary",category:"container",render(e){var t;const{children:n,childrenList:o}=e;return e={node:e.node,children:n||[],childrenList:o,style:e.node.style,text:"容器",class:"container-ordinary","data-key":e.id,events:(null==(t=e.node)?void 0:t.events)&&we.isPreview?pe.getRenderEvents(e.node.events):{}},i(me,e,null)},defaultData:{type:"container-ordinary",style:{position:"relative",width:"100%",zIndex:1},children:[]}},{label:"自由容器",icon:"icon iconfont icon-zidingyibuju",type:"container-free",category:"container",render(e){var t;const{children:n,childrenList:o}=e;return e={node:e.node,children:n||[],childrenList:o,style:e.node.style,text:"自由容器",class:"container-free","data-key":e.id,events:(null==(t=e.node)?void 0:t.events)&&we.isPreview?pe.getRenderEvents(e.node.events):{}},i(me,e,null)},defaultData:{type:"container-free",style:{position:"relative",width:"100%",zIndex:1},children:[]}},{label:"文字",icon:"icon iconfont icon-font",type:"text",category:"common",render(e){var t;let n=(null==(t=e.node)?void 0:t.events)&&we.isPreview?pe.getRenderEvents(e.node.events):{};return i("div",{class:"cannotPreview","data-key":e.id},[i("span",g({style:e.node.style},n,{datatype:"text"}),[e.node.children?e.node.children:"渲染文字"])])},defaultData:{type:"text",style:{position:"relative",fontSize:"16px",color:"black",zIndex:1},children:"渲染文字"}},{label:"按钮",icon:"icon iconfont icon-anniu",type:"button",category:"common",render(e){var t;let n=(null==(t=e.node)?void 0:t.events)&&we.isPreview?pe.getRenderEvents(e.node.events):{};return i("div",{class:"cannotPreview","data-key":e.id},[i(y,g({style:e.node.style,class:"baseButton",type:e.node.buttonstyle,size:e.node.size,disabled:e.node.isDisable},n),{default:()=>[i("i",{class:["icon iconfont leftIcon",e.node.icon.leftIcon],style:{"font-size":e.node.icon.leftIconSize}},null),e.node.children?e.node.children:"渲染按钮",i("i",{class:["icon iconfont rightIcon",e.node.icon.rightIcon],style:{"font-size":e.node.icon.rightIconSize}},null)]})])},defaultData:{type:"button",style:{position:"relative",width:"87px",height:"32px",zIndex:1},buttonstyle:"",size:"default",icon:{},twiceComfire:{},bubblePrompt:{},isDisable:!1,children:"渲染按钮"}},{label:"输入框",icon:"icon iconfont icon-input",type:"input",category:"common",render(e){var t;let n=(null==(t=e.node)?void 0:t.events)&&we.isPreview?pe.getRenderEvents(e.node.events):{};return i("div",{class:"cannotPreview","data-key":e.id},[i(ge,{option:e.node,events:n},null)])},defaultData:{type:"input",value:"",inputStyle:"text",size:"default",placeholder:"请输入",showPassword:!1,clearable:!1,showWordLimit:!1,disabled:!1,readonly:!1,autofocus:!1,style:{position:"relative",zIndex:1},children:""}},{label:"下拉框",icon:"icon iconfont icon-m-xialacaidan",type:"select",category:"common",render(e){var t;let n=(null==(t=e.node)?void 0:t.events)&&we.isPreview?pe.getRenderEvents(e.node.events):{};return i("div",{class:"cannotPreview","data-key":e.id},[i(fe,{option:e.node,events:n},null)])},defaultData:{type:"select",style:{position:"relative",zIndex:1},children:"",defaultValue:""}},{label:"文本框",icon:"icon iconfont icon-wenben",type:"textBox",category:"form",render(e){var t;let n=(null==(t=e.node)?void 0:t.events)&&we.isPreview?pe.getRenderEvents(e.node.events):{};return i("div",{class:"cannotPreview",style:e.node.style.box,"data-key":e.id},[i(ye,{option:e.node,events:n},null)])},defaultData:{value:"",type:"textBox",title:"文本",style:{box:{display:"block"},title:{},input:{}},children:""}},{label:"多行文本框",icon:"icon iconfont icon-duohangwenben1",type:"multilineText",category:"form",render(e){var t;let n=(null==(t=e.node)?void 0:t.events)&&we.isPreview?pe.getRenderEvents(e.node.events):{};return i("div",{class:"cannotPreview",style:e.node.style.box,"data-key":e.id},[i(he,{option:e.node,events:n},null)])},defaultData:{value:"",type:"multilineText",title:"多行文本",style:{box:{display:"block"},title:{},input:{}},children:"",autosize:{minRows:2,maxRows:6}}}];const Ce=new class{constructor(e=[],t=new Map,n=[]){this.componentList=e,this.componentMap=t,this.iconList=n}register(e,t=!1){t?this.iconList.push(e):this.componentList.push(e),this.componentMap.set(e.type,e)}};for(let Ke of be)Ce.register({label:Ke.label,type:Ke.type,category:Ke.category,defaultData:Ke.defaultData,display:!0,preview:()=>i(xe,{block:Ke}),render:e=>Ke.render(e)});for(let Ke of ve)Ce.register({label:Ke.label,type:"icon",category:"icon",display:!0,defaultData:{icon:Ke.icon,type:"icon",style:{position:"relative",fontSize:"16px",color:"black",zIndex:1},children:""},preview:()=>i("span",{datatype:"icon",class:"iconSpan"},[i("i",{class:Ke.icon},null)]),render:e=>i("div",{class:"cannotPreview","data-key":e.id},[i("i",{class:e.node.icon,style:e.node.style},null)])},!0);const xe=a({props:{block:{type:Object}},setup:e=>()=>i("span",{datatype:e.block.type},[i("i",{class:e.block.icon},null),i("label",null,[e.block.label])])});const Ee={__name:"settingPages",props:["modifyForm"],setup(e){const o=e,l=K(t);let a=p(null),d=h({username:"",oldPassword:"",newPassword:"",checkPassword:""});const c=()=>{a.value.validate((async e=>{if(!e)return;var t;let a=(await(t=d.username,T({method:"post",url:"/modfiyUserInfo/modifyUsername",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{username:t}}))).data;a.status?n.error(a.msg):(n.success(a.msg),l.username=a.username,P("username",a.username),d.username="",o.modifyForm.value=!1,d.username="")}))};let u=p(null);const m=()=>{u.value.validate((async e=>{if(!e)return;var t;let a=(await(t=d.newPassword,T({method:"post",url:"/modfiyUserInfo/modifyPassword",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{password:t}}))).data;a.status?n.error(a.msg):(n.success(a.msg),l.password=a.password,P("password",a.password),o.modifyForm.value=!1,d.oldPassword="",d.newPassword="",d.checkPassword="")}))};let g=h({username:[{min:3,max:10,message:"用户名长度应在 3-10 个字符",trigger:"blur"},{validator:async(e,t,n)=>{if(""===t)n(new Error("请新的输入用户名"));else{let e=(await V(d.username)).data;e.status?n(new Error(e.msg)):n()}},trigger:"blur"}],oldPassword:[{validator:async(e,t,n)=>{if(""===t)n(new Error("请输入原始密码"));else{if(""!==d.oldPassword){let e=await(o=d.oldPassword,T({method:"post",url:"/modfiyUserInfo/checkPassword",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{password:o}})),t=e.data;t.status?n(new Error(t.msg)):n()}n()}var o},trigger:"blur"}],newPassword:[{min:6,max:15,message:"密码长度应在 6-15 个字符",trigger:"blur"},{validator:(e,t,n)=>{""===t?n(new Error("请输入密码")):(""!==d.checkPassword&&u.value.validateField("checkPassword"),n())},trigger:"blur"}],checkPassword:[{validator:(e,t,n)=>{""===t?n(new Error("请再次输入密码")):t!==d.newPassword?n(new Error("两次输入密码不一致!")):n()},trigger:"blur"}]});const f=()=>{u.value.resetFields(),a.value.resetFields()};return(e,t)=>{const n=s("el-tab-pane"),o=s("el-tabs");return v(),w(o,{type:"border-card","tab-position":"left",class:"card",onTabClick:f},{default:b((()=>[i(n,{label:"修改用户名"},{default:b((()=>[i(C(x),{ref_key:"usernameFormRef",ref:a,model:C(d),rules:C(g),"label-width":"100px",autocomplete:"off"},{default:b((()=>[i(C(E),{label:"用户名：",prop:"username",class:"formItemCommon"},{default:b((()=>[i(C(r),{placeholder:"请输入新的用户名",modelValue:C(d).username,"onUpdate:modelValue":t[0]||(t[0]=e=>C(d).username=e),"input-style":"height:35px;",autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(C(E),{class:"btns"},{default:b((()=>[D("button",{class:"confirm",onClick:c},"立即修改")])),_:1})])),_:1},8,["model","rules"])])),_:1}),i(n,{label:"修改密码"},{default:b((()=>[i(C(x),{ref_key:"passwordFormRef",ref:u,model:C(d),rules:C(g),"label-width":"100px"},{default:b((()=>[i(C(E),{label:"原始密码：",prop:"oldPassword",class:"formItemCommon"},{default:b((()=>[i(C(r),{placeholder:"请输入原始密码",modelValue:C(d).oldPassword,"onUpdate:modelValue":t[1]||(t[1]=e=>C(d).oldPassword=e),"input-style":"height:35px;",autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(C(E),{label:"修改密码：",prop:"newPassword"},{default:b((()=>[i(C(r),{placeholder:"请输入新的密码",modelValue:C(d).newPassword,"onUpdate:modelValue":t[2]||(t[2]=e=>C(d).newPassword=e),"input-style":"height:35px;","show-password":"",type:"password",autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(C(E),{label:"确认密码：",prop:"checkPassword"},{default:b((()=>[i(C(r),{placeholder:"请再次输入密码",modelValue:C(d).checkPassword,"onUpdate:modelValue":t[3]||(t[3]=e=>C(d).checkPassword=e),"input-style":"height:35px;","show-password":"",type:"password"},null,8,["modelValue"])])),_:1}),i(C(E),{class:"btns"},{default:b((()=>[D("button",{class:"confirm",onClick:m},"立即修改")])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})}}},De=a({setup(){const e=p(!1);return()=>i("div",{class:"setting"},[i("div",{class:"setting-user"},[i("div",{class:"setting-user-portrait"},[i("img",{src:N},null)]),i("div",{class:"setting-user-info",title:M("username")},[M("username")])]),i("div",{class:"setting-line"},null),i("div",{class:"setting-common"},[i("div",{class:"icon iconfont icon-yonghu"},null),i("div",{class:"setting-common-name",onClick:()=>{k.push("/home")}},[u("我的主页")])]),i("div",{class:"setting-common",onClick:()=>{e.value=!0}},[i("div",{class:"icon iconfont icon-xiugai"},null),i("div",{class:"setting-common-name"},[u("我的设置")])]),i(s("el-dialog"),{title:"我的设置",modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,width:"540px"},{default:()=>[i(Ee,{modifyForm:e},null)]}),i("div",{class:"setting-common setting-warn",onClick:()=>(k.push("/login"),sessionStorage.clear(),void localStorage.clear())},[i("div",{class:"icon iconfont icon-h"},null),i("div",{class:"setting-common-name"},[u("退出登录")])])])}});let Pe=S(t);const Me=e=>e instanceof Array?e.map((e=>{let t=Me(e.children),n=h({node:e,children:t,style:e.style});return e.type.includes("container")&&(n.childrenList=e.children),Ce.componentMap.get(e.type).render(n)})):e,ke=e=>{let t=Pe.EditorDataMap.get(e);if(t.children instanceof Array)return t.children.map((e=>{var t;let n=ke(e),o=Pe.EditorDataMap.get(e),l=h({node:o,id:e,style:o.style});return o.type.includes("container")&&(l.children=n,l.childrenList=o.children),null==(t=Ce.componentMap.get(o.type))?void 0:t.render(l)}))};function Se(){return T({method:"get",url:"/getEditData",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function Le(e){return T({method:"post",url:"/delEditData",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{id:e}})}function Re(e){return T({method:"post",url:"/addEditData",headers:{"Content-Type":"application/json;charset=utf-8"},data:e})}function Te(e){return T({method:"post",url:"/updateEditData",headers:{"Content-Type":"application/json;charset=utf-8"},data:e})}export{se as B,De as P,Ce as a,ie as b,X as c,z as d,pe as e,Te as f,I as g,O as h,$ as i,W as j,Y as k,q as l,ke as m,G as n,Q as o,J as p,te as q,ne as r,H as s,oe as t,ae as u,le as v,Me as w,Se as x,Le as y,Re as z};
