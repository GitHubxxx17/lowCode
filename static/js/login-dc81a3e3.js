import{u as e,_ as a,c as s,r,l as o}from"./userStore-38c6f3d2.js";import{p as l,r as t,a as n,o as m,c as u,b as i,d,w as c,u as p,E as g,e as f,f as w,g as h,t as b,h as k,i as v,s as x}from"./index-66b152c9.js";const N={class:"login"},y={class:"login-box"},V=i("div",{class:"login-box-avatar"},[i("img",{src:a})],-1),_={__name:"login",setup(a){sessionStorage.clear();const _=e(l);let P=t({changeName:"注册",confirmName:"登录",isRegister:!1}),E=n(null);const R=()=>{"注册"==P.changeName?(P.isRegister=!0,P.changeName="登录",P.confirmName="注册"):(P.isRegister=!1,P.changeName="注册",P.confirmName="登录"),U.username="",U.password="",U.checkPassword="",E.value.resetFields()};let U=t({username:"",password:"",checkPassword:""});let j=t({username:[{min:3,max:10,message:"用户名长度应在 3-10 个字符",trigger:"blur"},{validator:async(e,a,r)=>{if(""===a)r(new Error("请输入用户名"));else{let e=await s(U.username);if("注册"===P.confirmName){let a=e.data;a.status?r(new Error(a.msg)):r()}else{e.data.status?r():r("该用户名不存在！")}}},trigger:"blur"}],password:[{min:6,max:15,message:"密码长度应在 6-15 个字符",trigger:"blur"},{validator:(e,a,s)=>{""===a?s(new Error("请输入密码")):(""!==U.checkPassword&&E.value.validateField("checkPassword"),s())},trigger:"blur"}],checkPassword:[{validator:(e,a,s)=>{""===a?s(new Error("请再次输入密码")):a!==U.password?s(new Error("两次输入密码不一致!")):s()},trigger:"blur"}]});return(e,a)=>(m(),u("div",N,[i("div",y,[V,d(p(k),{ref_key:"formRef",ref:E,model:p(U),rules:p(j),"label-width":"100px",class:"login-box-form",autocomplete:"off"},{default:c((()=>[d(p(g),{label:"用  户  名：",prop:"username"},{default:c((()=>[d(p(f),{placeholder:"请输入用户名",modelValue:p(U).username,"onUpdate:modelValue":a[0]||(a[0]=e=>p(U).username=e),"input-style":"height:35px;",autocomplete:"off"},null,8,["modelValue"])])),_:1}),d(p(g),{label:"密       码：",prop:"password"},{default:c((()=>[d(p(f),{placeholder:"请输入密码",modelValue:p(U).password,"onUpdate:modelValue":a[1]||(a[1]=e=>p(U).password=e),"input-style":"height:35px;","show-password":"",type:"password",autocomplete:"off"},null,8,["modelValue"])])),_:1}),p(P).isRegister?(m(),w(p(g),{key:0,label:"确认密码：",prop:"checkPassword"},{default:c((()=>[d(p(f),{placeholder:"请再次输入密码",modelValue:p(U).checkPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>p(U).checkPassword=e),"input-style":"height:35px;","show-password":"",type:"password",autocomplete:"off"},null,8,["modelValue"])])),_:1})):h("",!0),d(p(g),{class:"login-box-form-btns"},{default:c((()=>[i("button",{type:"button",class:"confirm",onClick:a[3]||(a[3]=a=>{return s=e.$router,void E.value.validate((async e=>{if(!e)return;let a=!1,l=null;if(l="注册"===P.confirmName?await r(U.username,U.password):await o(U.username,U.password),l){let e=l.data;e.status?v.error(e.msg):(v.success(e.msg),a=!0),a&&(_.username=e.username,_.token=e.token,x("token",e.token),x("username",e.username),s.push("/home"))}else v.success(P.confirmName+"异常，请重试！")}));var s})}," 立即"+b(p(P).confirmName),1),i("div",{class:"change",onClick:a[4]||(a[4]=e=>R())}," 去"+b(p(P).changeName),1)])),_:1})])),_:1},8,["model","rules"])])]))}};export{_ as default};
