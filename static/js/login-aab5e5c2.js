import{_ as N}from"./user-339da0c7.js";import{s as h}from"./index-765abcf3.js";import{r as p,a as P,o as f,c as _,b as i,d as t,w as n,u as r,E as u,e as g,f as V,g as y,t as w,h as E,i as c}from"./index-2d7a9430.js";function C(d,o){return h({method:"post",url:"/user/reguser",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{username:d,password:o}})}function R(d,o){return h({method:"post",url:"/user/login",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{username:d,password:o}})}const F={class:"login"},B={class:"login-box"},S=i("div",{class:"login-box-avatar"},[i("img",{src:N})],-1),T={__name:"login",setup(d){let o=p({changeName:"注册",confirmName:"登录",isRegister:!1}),m=P(null);const v=()=>{m.value.resetFields()},k=()=>{o.changeName=="注册"?(o.isRegister=!0,o.changeName="登录",o.confirmName="注册",a.username="",a.password="",a.checkPassword=""):(o.isRegister=!1,o.changeName="注册",o.confirmName="登录",a.username="",a.password="",a.checkPassword=""),v()};let a=p({username:"",password:"",checkPassword:""}),x=p({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"用户名长度应在 3-10 个字符",trigger:"blur"}],password:[{min:6,max:15,message:"密码长度应在 6-15 个字符",trigger:"blur"},{validator:(l,s,e)=>{s===""?e(new Error("请输入密码")):(a.checkPassword!==""&&m.value.validateField("checkPassword"),e())},trigger:"blur"}],checkPassword:[{validator:(l,s,e)=>{s===""?e(new Error("请再次输入密码")):s!==a.password?e(new Error("两次输入密码不一致!")):e()},trigger:"blur"}]});const b=()=>{m.value.validate(async l=>{if(console.log(l),!!l)if(o.confirmName==="注册"){let s=await C(a.username,a.password);console.log(s);let e=s.data;e.status?c.error(e.msg):c.success(e.msg)}else{let s=await R(a.username,a.password);console.log(s);let e=s.data;e.status?c.error(e.msg):c.success(e.msg)}})};return(l,s)=>(f(),_("div",F,[i("div",B,[S,t(r(E),{ref_key:"formRef",ref:m,model:r(a),rules:r(x),"label-width":"100px",class:"login-box-form",autocomplete:"off"},{default:n(()=>[t(r(u),{label:"用  户  名：",prop:"username"},{default:n(()=>[t(r(g),{placeholder:"请输入用户名",modelValue:r(a).username,"onUpdate:modelValue":s[0]||(s[0]=e=>r(a).username=e),"input-style":"height:35px;",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(r(u),{label:"密       码：",prop:"password"},{default:n(()=>[t(r(g),{placeholder:"请输入密码",modelValue:r(a).password,"onUpdate:modelValue":s[1]||(s[1]=e=>r(a).password=e),"input-style":"height:35px;","show-password":"",type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),r(o).isRegister?(f(),V(r(u),{key:0,label:"确认密码：",prop:"checkPassword"},{default:n(()=>[t(r(g),{placeholder:"请再次输入密码",modelValue:r(a).checkPassword,"onUpdate:modelValue":s[2]||(s[2]=e=>r(a).checkPassword=e),"input-style":"height:35px;","show-password":"",type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1})):y("",!0),t(r(u),{class:"login-box-form-btns"},{default:n(()=>[i("button",{class:"confirm",onClick:s[3]||(s[3]=e=>b())}," 立即"+w(r(o).confirmName),1),i("div",{class:"change",onClick:s[4]||(s[4]=e=>k())}," 去"+w(r(o).changeName),1)]),_:1})]),_:1},8,["model","rules"])])]))}};export{T as default};
