import{_ as T}from"./user-339da0c7.js";import{r as z,m as O,b,_ as P}from"./useRender-badd60bb.js";import{X as C,p as V,r as B,aE as F,aV as D,o as l,c as r,b as e,F as y,aT as L,d as h,u as E,w as u,Q as w,bM as _,i as k,av as M,t as J,aO as U,aL as G}from"./index-db3fcc8b.js";import{u as H,s as p}from"./userStore-efef8e53.js";const Q=""+new URL("../png/noneData1-cb06f12f.png",import.meta.url).href,R=C({props:{EditorData:Object},setup(d){return()=>{var s;return z((s=d.EditorData)==null?void 0:s.body)}}}),m=H(V);function X(){return p({method:"get",url:"/getEditData",headers:{"Content-Type":"application/x-www-form-urlencoded",authorization:m.token}})}function q(d){return p({method:"post",url:"/delEditData",headers:{"Content-Type":"application/x-www-form-urlencoded",authorization:m.token},data:{id:d}})}function A(d){return p({method:"post",url:"/addEditData",headers:{"Content-Type":"application/json;charset=utf-8",authorization:m.token},data:d})}const c=d=>(U("data-v-10b3fbd3"),d=d(),G(),d),K={class:"home"},W={class:"home-header"},Y=c(()=>e("div",{class:"home-header-left"},[e("h2",null,"codeFlow")],-1)),Z={class:"home-header-right"},tt=c(()=>e("div",{class:"home-header-right-avatar"},[e("img",{src:T,alt:"user"})],-1)),et={class:"home-body"},at={class:"home-body-left"},ot=c(()=>e("div",{class:"home-body-left-header"},[e("span",null,"我的页面")],-1)),st={class:"home-body-left-content"},dt=["onClick"],it={class:"title"},nt=["onClick"],lt={class:"home-body-right"},rt={key:0,class:"home-body-right-viewer"},ct={key:1,class:"home-body-right-none"},ht=c(()=>e("img",{src:Q,alt:"没有页面捏"},null,-1)),ut=[ht],_t=c(()=>e("span",null,"确认删除该页面吗？",-1)),pt={class:"dialog-footer"},mt=C({__name:"home",setup(d){const s=O(V),a=B({editdata:[],dialogVisible:!1,delIndex:0}),x=async()=>{let o=await X();a.editdata=o.data.editData.map((t,n)=>(t.jsonData=JSON.parse(t.jsonData),t.active=!1,n==0&&(t.active=!0,s.EditorData=t.jsonData,s.title=t.title),t)),console.log(a.editdata)},g=o=>{a.editdata.forEach((t,n)=>{t.active=!1,n==o&&(t.active=!0,s.EditorData=t.jsonData,s.title=t.title)})},I=o=>{o.push("/editor"),_("title",s.title),_("data",s.EditorData)},S=(o,t)=>{o.stopPropagation(),a.delIndex=t,a.dialogVisible=!0},j=async()=>{let o=await q(a.editdata[a.delIndex].id);console.log(o),a.dialogVisible=!1,a.editdata.splice(a.delIndex,1);let t=a.editdata.length;if(t==0){s.EditorData=null,localStorage.removeItem("title"),localStorage.removeItem("data");return}g(a.delIndex==t?a.delIndex-1:a.delIndex),k.success({message:o.data.msg,duration:2e3})},$=async o=>{let t=await A({title:"未命名页面",jsonData:JSON.stringify(b)});k.success({message:t.data.msg,duration:1e3}),o.push("/editor"),_("title","未命名页面"),_("data",b),console.log(t)};return F(()=>{x()}),(o,t)=>{const n=D("el-button"),N=D("el-dialog");return l(),r(y,null,[e("div",K,[e("header",W,[Y,e("div",Z,[e("div",{class:"home-header-right-btn",onClick:t[0]||(t[0]=i=>I(o.$router))}," 进入编辑 "),e("div",{class:"home-header-right-btn",onClick:t[1]||(t[1]=i=>$(o.$router))}," 新建页面 "),tt])]),e("section",et,[e("div",at,[ot,e("div",st,[e("ul",null,[(l(!0),r(y,null,L(a.editdata,(i,f)=>(l(),r("li",{class:M({active:i.active}),onClick:v=>g(f),key:i.id},[e("div",it,J(i.title),1),e("i",{class:"del icon iconfont icon-cha",onClick:v=>S(v,f)},null,8,nt)],10,dt))),128))])])]),e("div",lt,[a.editdata.length?(l(),r("div",rt,[h(E(R),{EditorData:E(s).EditorData},null,8,["EditorData"])])):(l(),r("div",ct,ut))])])]),h(N,{title:"删除页面",modelValue:a.dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=i=>a.dialogVisible=i),width:"30%"},{footer:u(()=>[e("span",pt,[h(n,{onClick:t[2]||(t[2]=i=>a.dialogVisible=!1)},{default:u(()=>[w("取 消")]),_:1}),h(n,{type:"primary",onClick:j},{default:u(()=>[w("确 定")]),_:1})])]),default:u(()=>[_t]),_:1},8,["modelValue"])],64)}}});const Dt=P(mt,[["__scopeId","data-v-10b3fbd3"]]);export{Dt as default};
