import{u as j,_ as $}from"./userStore-66ba42f0.js";import{r as N,m as O,P as B,i as F,j as M,k as U,g as v}from"./home-72d8f345.js";import{X as k,p as f,bP as G,r as J,aE as L,aV as D,o as c,c as _,b as a,d as l,w as n,u as h,bO as T,F as b,aT as z,Q as y,bM as r,i as E,av as H,t as Q}from"./index-12cc8c98.js";const R=""+new URL("../png/noneData1-cb06f12f.png",import.meta.url).href,X=k({props:{EditorData:Object},setup(u){return()=>{var s;return N((s=u.EditorData)==null?void 0:s.body)}}}),q={class:"home"},A={class:"home-header"},K=a("div",{class:"home-header-left"},[a("h2",null,"codeFlow")],-1),W={class:"home-header-right"},Y=a("div",{class:"home-header-right-avatar"},[a("img",{src:$,alt:"user"})],-1),Z={class:"home-body"},ee={class:"home-body-left"},te=a("div",{class:"home-body-left-header"},[a("span",null,"我的页面")],-1),ae={class:"home-body-left-content"},oe=["onClick"],se={class:"title"},de=["onClick"],ie={class:"home-body-right"},le={key:0,class:"home-body-right-viewer"},ne={key:1,class:"home-body-right-none"},re=a("img",{src:R,alt:"没有页面捏"},null,-1),ce=[re],_e=a("span",null,"确认删除该页面吗？",-1),he={class:"dialog-footer"},pe=k({__name:"home",setup(u){const s=O(f),x=j(f);x.token=G("token");const t=J({editdata:[],dialogVisible:!1,delIndex:0,selectIndex:0}),V=async()=>{let o=await F();t.editdata=o.data.editData.map((e,i)=>(e.jsonData=JSON.parse(e.jsonData),e.active=!1,i==0&&(e.active=!0,s.EditorData=e.jsonData,s.title=e.title,t.selectIndex=e.id),e)),console.log(t.editdata)},g=o=>{t.editdata.forEach((e,i)=>{e.active=!1,i==o&&(e.active=!0,s.EditorData=e.jsonData,s.title=e.title,t.selectIndex=e.id)})},I=o=>{o.push("/editor"),r("title",s.title),r("data",s.EditorData),r("id",t.selectIndex)},C=(o,e)=>{o.stopPropagation(),t.delIndex=e,t.dialogVisible=!0},w=async()=>{let o=await M(t.editdata[t.delIndex].id);console.log(o),t.dialogVisible=!1,t.editdata.splice(t.delIndex,1);let e=t.editdata.length;if(e==0){s.EditorData=null,localStorage.removeItem("title"),localStorage.removeItem("data");return}g(t.delIndex==e?t.delIndex-1:t.delIndex),E.success({message:o.data.msg,duration:2e3})},P=async o=>{let e=await U({title:"未命名页面",jsonData:JSON.stringify(v)});E.success({message:e.data.msg,duration:1e3}),o.push("/editor"),r("title","未命名页面"),r("data",v),r("id",e.data.id),console.log(e)};return L(()=>{V()}),(o,e)=>{const i=D("el-button"),S=D("el-dialog");return c(),_(b,null,[a("div",q,[a("header",A,[K,a("div",W,[a("div",{class:"home-header-right-btn",onClick:e[0]||(e[0]=d=>I(o.$router))}," 进入编辑 "),a("div",{class:"home-header-right-btn",onClick:e[1]||(e[1]=d=>P(o.$router))}," 新建页面 "),l(h(T),{placement:"bottom",width:200,trigger:"click"},{reference:n(()=>[Y]),default:n(()=>[l(h(B))]),_:1})])]),a("section",Z,[a("div",ee,[te,a("div",ae,[a("ul",null,[(c(!0),_(b,null,z(t.editdata,(d,m)=>(c(),_("li",{class:H({active:d.active}),onClick:p=>g(m),key:d.id},[a("div",se,Q(d.title),1),a("i",{class:"del icon iconfont icon-cha",onClick:p=>C(p,m)},null,8,de)],10,oe))),128))])])]),a("div",ie,[t.editdata.length?(c(),_("div",le,[l(h(X),{EditorData:h(s).EditorData},null,8,["EditorData"])])):(c(),_("div",ne,ce))])])]),l(S,{title:"删除页面",modelValue:t.dialogVisible,"onUpdate:modelValue":e[3]||(e[3]=d=>t.dialogVisible=d),width:"30%"},{footer:n(()=>[a("span",he,[l(i,{onClick:e[2]||(e[2]=d=>t.dialogVisible=!1)},{default:n(()=>[y("取 消")]),_:1}),l(i,{type:"primary",onClick:w},{default:n(()=>[y("确 定")]),_:1})])]),default:n(()=>[_e]),_:1},8,["modelValue"])],64)}}});export{pe as default};
