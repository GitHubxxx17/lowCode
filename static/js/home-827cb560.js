import{u as N,_ as O}from"./index-91f3b10c.js";import{r as L,m as P,g as B,h as F,i as G,c as v,_ as J}from"./home-10abca06.js";import{X as k,p as f,bL as M,r as T,aE as U,aV as D,o as r,c,b as a,F as b,aT as z,d as h,u as y,w as u,Q as E,bO as n,i as I,av as H,t as Q,aO as R,aL as X}from"./index-7b9469f6.js";const q=""+new URL("../png/noneData1-cb06f12f.png",import.meta.url).href,A=k({props:{EditorData:Object},setup(i){return()=>{var s;return L((s=i.EditorData)==null?void 0:s.body)}}}),_=i=>(R("data-v-d0418176"),i=i(),X(),i),K={class:"home"},W={class:"home-header"},Y=_(()=>a("div",{class:"home-header-left"},[a("h2",null,"codeFlow")],-1)),Z={class:"home-header-right"},ee=_(()=>a("div",{class:"home-header-right-avatar"},[a("img",{src:O,alt:"user"})],-1)),te={class:"home-body"},ae={class:"home-body-left"},oe=_(()=>a("div",{class:"home-body-left-header"},[a("span",null,"我的页面")],-1)),se={class:"home-body-left-content"},de=["onClick"],ie={class:"title"},le=["onClick"],ne={class:"home-body-right"},re={key:0,class:"home-body-right-viewer"},ce={key:1,class:"home-body-right-none"},_e=_(()=>a("img",{src:q,alt:"没有页面捏"},null,-1)),he=[_e],ue=_(()=>a("span",null,"确认删除该页面吗？",-1)),pe={class:"dialog-footer"},ge=k({__name:"home",setup(i){const s=P(f),x=N(f);x.token=M("token");const t=T({editdata:[],dialogVisible:!1,delIndex:0,selectIndex:0}),V=async()=>{let o=await B();t.editdata=o.data.editData.map((e,l)=>(e.jsonData=JSON.parse(e.jsonData),e.active=!1,l==0&&(e.active=!0,s.EditorData=e.jsonData,s.title=e.title,t.selectIndex=e.id),e)),console.log(t.editdata)},p=o=>{t.editdata.forEach((e,l)=>{e.active=!1,l==o&&(e.active=!0,s.EditorData=e.jsonData,s.title=e.title,t.selectIndex=e.id)})},C=o=>{o.push("/editor"),n("title",s.title),n("data",s.EditorData),n("id",t.selectIndex)},w=(o,e)=>{o.stopPropagation(),t.delIndex=e,t.dialogVisible=!0},S=async()=>{let o=await F(t.editdata[t.delIndex].id);console.log(o),t.dialogVisible=!1,t.editdata.splice(t.delIndex,1);let e=t.editdata.length;if(e==0){s.EditorData=null,localStorage.removeItem("title"),localStorage.removeItem("data");return}p(t.delIndex==e?t.delIndex-1:t.delIndex),I.success({message:o.data.msg,duration:2e3})},j=async o=>{let e=await G({title:"未命名页面",jsonData:JSON.stringify(v)});I.success({message:e.data.msg,duration:1e3}),o.push("/editor"),n("title","未命名页面"),n("data",v),n("id",e.data.id),console.log(e)};return U(()=>{V()}),(o,e)=>{const l=D("el-button"),$=D("el-dialog");return r(),c(b,null,[a("div",K,[a("header",W,[Y,a("div",Z,[a("div",{class:"home-header-right-btn",onClick:e[0]||(e[0]=d=>C(o.$router))}," 进入编辑 "),a("div",{class:"home-header-right-btn",onClick:e[1]||(e[1]=d=>j(o.$router))}," 新建页面 "),ee])]),a("section",te,[a("div",ae,[oe,a("div",se,[a("ul",null,[(r(!0),c(b,null,z(t.editdata,(d,g)=>(r(),c("li",{class:H({active:d.active}),onClick:m=>p(g),key:d.id},[a("div",ie,Q(d.title),1),a("i",{class:"del icon iconfont icon-cha",onClick:m=>w(m,g)},null,8,le)],10,de))),128))])])]),a("div",ne,[t.editdata.length?(r(),c("div",re,[h(y(A),{EditorData:y(s).EditorData},null,8,["EditorData"])])):(r(),c("div",ce,he))])])]),h($,{title:"删除页面",modelValue:t.dialogVisible,"onUpdate:modelValue":e[3]||(e[3]=d=>t.dialogVisible=d),width:"30%"},{footer:u(()=>[a("span",pe,[h(l,{onClick:e[2]||(e[2]=d=>t.dialogVisible=!1)},{default:u(()=>[E("取 消")]),_:1}),h(l,{type:"primary",onClick:S},{default:u(()=>[E("确 定")]),_:1})])]),default:u(()=>[ue]),_:1},8,["modelValue"])],64)}}});const De=J(ge,[["__scopeId","data-v-d0418176"]]);export{De as default};
